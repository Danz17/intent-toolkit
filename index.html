<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#1a1a2e">
  <link rel="icon" type="image/png" href="https://adbappcontrol.com/assets/img/logo_blue.png">
  <link rel="apple-touch-icon" href="https://adbappcontrol.com/assets/img/logo_blue.png">
  <title>Intent Toolkit - FRP Research</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #eee;
      min-height: 100vh;
      padding: 10px;
      padding-bottom: 80px;
    }

    h1 {
      text-align: center;
      color: #00d4ff;
      font-size: 1.5rem;
      margin-bottom: 5px;
    }
    h2 {
      color: #ff6b6b;
      margin: 15px 0 10px;
      font-size: 1.1rem;
      border-bottom: 2px solid #ff6b6b;
      padding-bottom: 5px;
    }
    h3 {
      color: #ffd93d;
      margin: 12px 0 8px;
      font-size: 0.95rem;
    }
    .subtitle {
      text-align: center;
      color: #888;
      font-size: 0.75rem;
      margin-bottom: 15px;
    }

    .container { max-width: 800px; margin: 0 auto; }

    /* Mobile-first tabs */
    .tabs {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 5px;
      margin-bottom: 10px;
      padding-bottom: 5px;
      -webkit-overflow-scrolling: touch;
    }
    .tabs::-webkit-scrollbar { display: none; }

    .tab {
      padding: 10px 14px;
      background: #0d1b2a;
      border: none;
      color: #888;
      cursor: pointer;
      border-radius: 8px;
      font-size: 0.8rem;
      white-space: nowrap;
      flex-shrink: 0;
    }
    .tab.active {
      background: #1e3a5f;
      color: #00d4ff;
      font-weight: bold;
    }
    .tab-content { display: none; }
    .tab-content.active { display: block; }

    /* Intent Links - Large touch targets */
    .grid {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .intent-link {
      display: block;
      background: #0d1b2a;
      color: #00d4ff;
      padding: 14px 12px;
      text-decoration: none;
      border-radius: 10px;
      border-left: 4px solid #00d4ff;
      font-size: 0.75rem;
      word-break: break-all;
      cursor: pointer;
      transition: transform 0.1s, background 0.2s;
      -webkit-user-select: none;
      user-select: none;
    }
    .intent-link:active {
      transform: scale(0.98);
      background: #1e3a5f;
    }
    .intent-link .label {
      display: block;
      color: #ffd93d;
      font-weight: bold;
      margin-bottom: 4px;
      font-size: 0.95rem;
    }
    .intent-link .url {
      opacity: 0.8;
      font-size: 0.7rem;
    }

    /* Color variants */
    .tel-link { border-left-color: #ff6b6b; }
    .tel-link .label { color: #ff9f43; }

    .samsung-link { border-left-color: #a855f7; }
    .samsung-link .label { color: #c084fc; }

    .working { border-left-color: #22c55e !important; background: #0a1f12; }
    .working .label { color: #22c55e !important; }

    .priority {
      border-left-color: #f59e0b !important;
      border-width: 5px;
      background: #1a1505;
    }
    .priority .label { color: #fbbf24 !important; font-size: 1rem; }

    /* Notes */
    .note {
      background: #2d1b00;
      border-left: 4px solid #ff9f43;
      padding: 10px 12px;
      margin: 10px 0;
      border-radius: 0 8px 8px 0;
      font-size: 0.8rem;
    }
    .note.success {
      background: #0d2818;
      border-left-color: #22c55e;
    }
    .note.info {
      background: #0d1b2a;
      border-left-color: #00d4ff;
    }

    /* QR Section - Collapsible on mobile */
    .qr-section {
      background: #1e3a5f;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 15px;
      text-align: center;
    }
    .qr-section.collapsed .qr-content { display: none; }
    .qr-toggle {
      background: none;
      border: none;
      color: #00d4ff;
      font-size: 1rem;
      cursor: pointer;
      width: 100%;
      padding: 5px;
    }
    #qr-input {
      width: 100%;
      padding: 12px;
      font-size: 14px;
      border: none;
      border-radius: 8px;
      margin-bottom: 10px;
      background: #0d1b2a;
      color: #fff;
    }
    .btn-row {
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
    }
    .btn {
      padding: 12px 20px;
      background: #00d4ff;
      color: #000;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9rem;
    }
    .btn:active { transform: scale(0.95); }
    .btn-secondary { background: #ff6b6b; }
    .btn-green { background: #22c55e; }

    #qr-code {
      margin: 15px auto;
      padding: 10px;
      background: #fff;
      border-radius: 12px;
      display: inline-block;
    }

    /* Quick Actions - Fixed bottom bar on mobile */
    .quick-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #0d1b2a;
      padding: 10px;
      display: flex;
      gap: 8px;
      justify-content: center;
      border-top: 1px solid #333;
      z-index: 100;
    }
    .quick-btn {
      padding: 10px 12px;
      background: #1e3a5f;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 0.75rem;
      cursor: pointer;
      flex: 1;
      max-width: 100px;
    }
    .quick-btn:active { background: #2a4a6f; }
    .quick-btn.highlight { background: #22c55e; color: #000; }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 10px 0;
      font-size: 0.8rem;
    }
    th, td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #333;
    }
    th { background: #0d1b2a; color: #ffd93d; }

    code {
      background: #0d1b2a;
      padding: 2px 5px;
      border-radius: 4px;
      color: #00d4ff;
      font-size: 0.7rem;
    }
    pre {
      background: #0d1b2a;
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 0.7rem;
      color: #00d4ff;
    }

    /* Desktop adjustments */
    @media (min-width: 600px) {
      body { padding: 20px; }
      h1 { font-size: 1.8rem; }
      .grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
      }
      .intent-link { font-size: 0.8rem; }
      .intent-link .label { font-size: 1rem; }
      .quick-bar { display: none; }
      body { padding-bottom: 20px; }
    }

    /* Category divider */
    .divider {
      text-align: center;
      color: #666;
      margin: 20px 0 10px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    /* Status badge */
    .badge {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.65rem;
      margin-left: 5px;
      vertical-align: middle;
    }
    .badge-working { background: #22c55e; color: #000; }
    .badge-try { background: #f59e0b; color: #000; }
    .badge-blocked { background: #ef4444; color: #fff; }

    /* Device-specific visibility classes */
    .blocked-on-device {
      opacity: 0.35;
      pointer-events: none;
      position: relative;
    }
    .blocked-on-device .label {
      text-decoration: line-through;
      color: #666 !important;
    }
    .blocked-on-device::after {
      content: "âœ— SM-S721B";
      position: absolute;
      top: 5px;
      right: 8px;
      font-size: 0.6rem;
      color: #ef4444;
      background: rgba(0,0,0,0.5);
      padding: 2px 5px;
      border-radius: 3px;
    }

    /* Assistant section special styling */
    .assistant-link {
      border-left-color: #4ade80 !important;
      background: linear-gradient(90deg, #0a1f12 0%, #0d1b2a 100%);
    }
    .assistant-link .label { color: #4ade80 !important; }
    .assistant-link .voice-cmd {
      display: block;
      color: #86efac;
      font-style: italic;
      margin-top: 4px;
      font-size: 0.85rem;
    }
    .assistant-link .voice-cmd::before { content: 'ğŸ—£ï¸ "'; }
    .assistant-link .voice-cmd::after { content: '"'; }

    /* Works badge */
    .works-on-device {
      border-left-color: #22c55e !important;
      background: #0a1f12;
    }
    .works-on-device .label { color: #22c55e !important; }

    /* Database Tab - Mobile-First Category View */
    .db-sticky-bar {
      position: sticky;
      top: 0;
      z-index: 50;
      background: #0d1b2a;
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 10px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .db-sticky-bar input {
      flex: 1;
      padding: 10px 12px;
      font-size: 14px;
      border: none;
      border-radius: 8px;
      background: #1e3a5f;
      color: #fff;
    }
    .db-sticky-bar input::placeholder { color: #888; }
    .db-bar-info {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      color: #888;
      white-space: nowrap;
    }
    .btn-reset {
      padding: 8px 12px;
      background: #ef4444;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 0.8rem;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-reset:active { transform: scale(0.95); }

    /* Category Sections */
    .db-category {
      background: #0d1b2a;
      border-radius: 12px;
      margin-bottom: 10px;
      overflow: hidden;
    }
    .db-cat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 12px;
      background: #1e3a5f;
      cursor: pointer;
      user-select: none;
    }
    .db-cat-header:active { background: #2a4a6f; }
    .db-cat-title {
      font-size: 1rem;
      font-weight: bold;
      color: #00d4ff;
    }
    .db-cat-title .icon { margin-right: 8px; font-size: 1.2rem; }
    .db-cat-count {
      background: #00d4ff;
      color: #000;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.7rem;
      font-weight: bold;
    }
    .db-cat-body {
      display: none;
      padding: 8px;
    }
    .db-category.open .db-cat-body { display: block; }
    .db-category.open .db-cat-header { background: #2a4a6f; }

    /* Intent Cards */
    .intent-card {
      display: block;
      background: #16213e;
      border-left: 4px solid #00d4ff;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.15s;
    }
    .intent-card:active { transform: scale(0.98); background: #1e3a5f; }
    .intent-card .ic-label {
      font-weight: bold;
      color: #ffd93d;
      font-size: 0.95rem;
      margin-bottom: 4px;
    }
    .intent-card .ic-purpose {
      color: #aaa;
      font-size: 0.8rem;
    }

    /* Tried/Greyed out state */
    .intent-card.tried {
      opacity: 0.4;
      border-left-color: #666;
    }
    .intent-card.tried .ic-label { color: #888; }
    .intent-card.last-tried {
      opacity: 0.5;
      border-left-color: #f59e0b;
      background: #1a1505;
    }
    .intent-card.last-tried::after {
      content: " â† Last tried";
      color: #f59e0b;
      font-size: 0.7rem;
    }

    /* Category priority colors */
    .db-category[data-priority="critical"] .db-cat-header { border-left: 4px solid #ef4444; }
    .db-category[data-priority="high"] .db-cat-header { border-left: 4px solid #f59e0b; }
    .db-category[data-priority="medium"] .db-cat-header { border-left: 4px solid #00d4ff; }
    .db-category[data-priority="low"] .db-cat-header { border-left: 4px solid #666; }

    /* Hidden when filtered out */
    .db-category.hidden, .intent-card.hidden { display: none; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”“ Intent Toolkit</h1>
    <p class="subtitle">FRP Security Research | SM-S721B | By Phenix</p>

    <!-- Quick Priority Section -->
    <div class="note success">
      âš¡ <strong>TAP ANY LINK</strong> to open directly, or scroll down for QR codes
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab" onclick="showTab('assistant')">ğŸ—£ï¸ Assistant</button>
      <button class="tab active" onclick="showTab('priority')">â­ Priority</button>
      <button class="tab" onclick="showTab('packages')">ğŸ“¦ Packages</button>
      <button class="tab" onclick="showTab('samsung')">ğŸ“± Samsung</button>
      <button class="tab" onclick="showTab('codes')">ğŸ”¢ Codes</button>
      <button class="tab" onclick="showTab('qr')">ğŸ“· QR Gen</button>
      <button class="tab" onclick="showTab('database')">ğŸ“Š Database</button>
      <button class="tab" onclick="showTab('docs')">ğŸ“– Docs</button>
    </div>

    <!-- ASSISTANT TAB - Voice commands that work! -->
    <div id="assistant" class="tab-content">
      <h2>ğŸ—£ï¸ Google Assistant Commands</h2>

      <div class="note success">
        âœ… <strong>BREAKTHROUGH!</strong> Google Assistant can open apps during FRP lock!<br>
        Say "Hey Google" or hold the home button, then use these commands.
      </div>

      <h3>âœ… Verified Working (SM-S721B)</h3>
      <div class="grid">
        <div class="intent-link assistant-link works-on-device">
          <span class="label">ğŸ“± Display Settings</span>
          <span class="voice-cmd">Open Display Settings</span>
          <span class="url">âœ… Works on SM-S721B</span>
        </div>

        <div class="intent-link assistant-link works-on-device">
          <span class="label">â™¿ Accessibility Settings</span>
          <span class="voice-cmd">Open Accessibility</span>
          <span class="url">âœ… Works on SM-S721B</span>
        </div>

        <div class="intent-link assistant-link works-on-device">
          <span class="label">ğŸ”Š Sound Settings</span>
          <span class="voice-cmd">Open Sound Settings</span>
          <span class="url">âœ… Works on SM-S721B</span>
        </div>

        <div class="intent-link assistant-link works-on-device">
          <span class="label">ğŸ”” Notification Settings</span>
          <span class="voice-cmd">Open Notifications</span>
          <span class="url">âœ… Works on SM-S721B</span>
        </div>

        <div class="intent-link assistant-link works-on-device">
          <span class="label">â„¹ï¸ Device Info / About</span>
          <span class="voice-cmd">Open Device Info</span>
          <span class="url">âœ… Works - but Dev Options won't toggle!</span>
        </div>
      </div>

      <h3>âš ï¸ Partial (Opens then Closes)</h3>
      <div class="grid">
        <div class="intent-link assistant-link" style="border-left-color: #f59e0b;">
          <span class="label" style="color: #f59e0b;">ğŸª Play Store</span>
          <span class="voice-cmd">Open Play Store</span>
          <span class="url">Opens â†’ asks for update â†’ closes. After update: blocked</span>
        </div>

        <div class="intent-link assistant-link" style="border-left-color: #f59e0b;">
          <span class="label" style="color: #f59e0b;">â–¶ï¸ YouTube</span>
          <span class="voice-cmd">Open YouTube</span>
          <span class="url">Opens â†’ asks for update â†’ closes. After update: blocked</span>
        </div>
      </div>

      <h3>ğŸ” Try These Commands</h3>
      <div class="grid">
        <div class="intent-link assistant-link">
          <span class="label">âš™ï¸ Settings</span>
          <span class="voice-cmd">Open Settings</span>
          <span class="url">Try this!</span>
        </div>

        <div class="intent-link assistant-link">
          <span class="label">ğŸ“ Files</span>
          <span class="voice-cmd">Open Files</span>
          <span class="url">Try this!</span>
        </div>

        <div class="intent-link assistant-link">
          <span class="label">ğŸ”§ Developer Options</span>
          <span class="voice-cmd">Open Developer Options</span>
          <span class="url">Try this!</span>
        </div>

        <div class="intent-link assistant-link">
          <span class="label">ğŸ“¶ WiFi Settings</span>
          <span class="voice-cmd">Open WiFi Settings</span>
          <span class="url">Try this!</span>
        </div>

        <div class="intent-link assistant-link">
          <span class="label">ğŸ”µ Bluetooth Settings</span>
          <span class="voice-cmd">Open Bluetooth</span>
          <span class="url">Try this!</span>
        </div>

        <div class="intent-link assistant-link">
          <span class="label">ğŸ”’ Security Settings</span>
          <span class="voice-cmd">Open Security Settings</span>
          <span class="url">Try this!</span>
        </div>
      </div>

      <h3>ğŸ’¡ Research Notes</h3>
      <div class="note info">
        <strong>IntentResolver Crash:</strong> Some share requests cause the IntentResolver app to crash.
        This might be exploitable for navigation bypass.
      </div>
    </div>

    <!-- PRIORITY TAB - Most likely to work -->
    <div id="priority" class="tab-content active">
      <h2>â­ Try These First</h2>

      <!-- SM-S721B: All Chrome intent:// URLs are BLOCKED on this device -->
      <div class="note" style="background:#2a1515; border-color:#ef4444;">
        âš ï¸ <strong>SM-S721B Notice:</strong> Chrome intent:// URLs are blocked on this device.
        Use <strong>Google Assistant</strong> tab instead!
      </div>

      <div class="grid">
        <a class="intent-link priority blocked-on-device" href="intent://com.android.settings/#Intent;scheme=android-app;end">
          <span class="label">âš™ï¸ SETTINGS APP</span>
          <span class="url">intent://com.android.settings/#Intent;scheme=android-app;end</span>
        </a>

        <a class="intent-link priority blocked-on-device" href="intent://com.sec.android.app.launcher/#Intent;scheme=android-app;end">
          <span class="label">ğŸ  SAMSUNG LAUNCHER</span>
          <span class="url">intent://com.sec.android.app.launcher/#Intent;scheme=android-app;end</span>
        </a>

        <a class="intent-link priority blocked-on-device" href="intent://com.sec.android.app.myfiles/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“ MY FILES</span>
          <span class="url">intent://com.sec.android.app.myfiles/#Intent;scheme=android-app;end</span>
        </a>

        <a class="intent-link priority blocked-on-device" href="intent://com.samsung.android.dialer/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“ SAMSUNG PHONE (for codes)</span>
          <span class="url">intent://com.samsung.android.dialer/#Intent;scheme=android-app;end</span>
        </a>
      </div>

      <h3>ğŸ”‘ Critical Dialer Codes</h3>
      <div class="note info">If you can access the Phone app, dial these codes:</div>
      <div class="grid">
        <!-- SM-S721B: Secret codes don't trigger from tel: links -->
        <a class="intent-link tel-link priority blocked-on-device" href="tel:*#0808#">
          <span class="label">â­ *#0808# - USB/ADB MODE</span>
          <span class="url">Opens USB settings - Enable MTP+ADB!</span>
        </a>

        <a class="intent-link tel-link blocked-on-device" href="tel:*#0*#">
          <span class="label">ğŸ”§ *#0*# - Hardware Test</span>
          <span class="url">Diagnostic menu with various tests</span>
        </a>

        <a class="intent-link tel-link blocked-on-device" href="tel:*#9900#">
          <span class="label">ğŸ“Š *#9900# - SysDump</span>
          <span class="url">Debug logs and settings</span>
        </a>
      </div>

      <h3>ğŸ”§ Developer Options</h3>
      <div class="grid">
        <!-- SM-S721B: Dev Options intent blocked, and 7x build number tap doesn't work -->
        <a class="intent-link working blocked-on-device" href="intent://com.android.settings/.DevelopmentSettings/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”§ Developer Options (Direct)</span>
          <span class="url">intent://com.android.settings/.DevelopmentSettings/#Intent;scheme=android-app;end</span>
        </a>

        <a class="intent-link blocked-on-device" href="intent://com.android.settings/.Settings$DevelopmentSettingsDashboardActivity/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”§ Dev Options Dashboard</span>
          <span class="url">intent://...DevelopmentSettingsDashboardActivity/...</span>
        </a>
      </div>

      <h3>ğŸ“± Escape Routes</h3>
      <div class="grid">
        <!-- SM-S721B: All intent:// links blocked -->
        <a class="intent-link samsung-link blocked-on-device" href="intent://com.samsung.android.voc/#Intent;scheme=android-app;end">
          <span class="label">ğŸ‘¥ Samsung Members</span>
          <span class="url">May have browser links inside</span>
        </a>

        <a class="intent-link samsung-link blocked-on-device" href="intent://com.sec.android.app.samsungapps/#Intent;scheme=android-app;end">
          <span class="label">ğŸª Galaxy Store</span>
          <span class="url">Can sometimes escape to settings</span>
        </a>

        <a class="intent-link samsung-link blocked-on-device" href="intent://com.samsung.android.oneconnect/#Intent;scheme=android-app;end">
          <span class="label">ğŸ  SmartThings</span>
          <span class="url">Has web content that may escape</span>
        </a>

        <a class="intent-link blocked-on-device" href="intent://com.android.documentsui/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“‚ Document Browser</span>
          <span class="url">File access may lead to APK install</span>
        </a>
      </div>
    </div>

    <!-- PACKAGES TAB -->
    <div id="packages" class="tab-content">
      <h2>ğŸ“¦ Package Launch Intents</h2>
      <div class="note">Format: <code>intent://[package]/#Intent;scheme=android-app;end</code></div>

      <h3>System Apps</h3>
      <div class="grid">
        <a class="intent-link" href="intent://com.android.settings/#Intent;scheme=android-app;end">
          <span class="label">âš™ï¸ Settings</span>
          <span class="url">intent://com.android.settings/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.android.dialer/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“ Dialer</span>
          <span class="url">intent://com.android.dialer/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.android.contacts/#Intent;scheme=android-app;end">
          <span class="label">ğŸ‘¤ Contacts</span>
          <span class="url">intent://com.android.contacts/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.android.chrome/#Intent;scheme=android-app;end">
          <span class="label">ğŸŒ Chrome</span>
          <span class="url">intent://com.android.chrome/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.android.documentsui/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“‚ Documents</span>
          <span class="url">intent://com.android.documentsui/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.android.packageinstaller/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“¦ Package Installer</span>
          <span class="url">intent://com.android.packageinstaller/#Intent;scheme=android-app;end</span>
        </a>
      </div>

      <h3>Google Apps</h3>
      <div class="grid">
        <a class="intent-link" href="intent://com.google.android.googlequicksearchbox/#Intent;scheme=android-app;end">
          <span class="label">ğŸ” Google</span>
          <span class="url">intent://com.google.android.googlequicksearchbox/...</span>
        </a>
        <a class="intent-link" href="intent://com.google.android.gms/#Intent;scheme=android-app;end">
          <span class="label">âš™ï¸ Play Services</span>
          <span class="url">intent://com.google.android.gms/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.android.vending/#Intent;scheme=android-app;end">
          <span class="label">ğŸª Play Store</span>
          <span class="url">intent://com.android.vending/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.google.android.youtube/#Intent;scheme=android-app;end">
          <span class="label">â–¶ï¸ YouTube</span>
          <span class="url">intent://com.google.android.youtube/#Intent;scheme=android-app;end</span>
        </a>
        <a class="intent-link" href="intent://com.google.android.apps.photos/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“· Photos</span>
          <span class="url">intent://com.google.android.apps.photos/#Intent;scheme=android-app;end</span>
        </a>
      </div>

      <h3>Settings Activities (Direct)</h3>
      <div class="grid">
        <a class="intent-link" href="intent://com.android.settings/.Settings$WifiSettingsActivity/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“¶ WiFi Settings</span>
          <span class="url">intent://...WifiSettingsActivity/...</span>
        </a>
        <a class="intent-link" href="intent://com.android.settings/.Settings$BluetoothSettingsActivity/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”µ Bluetooth</span>
          <span class="url">intent://...BluetoothSettingsActivity/...</span>
        </a>
        <a class="intent-link" href="intent://com.android.settings/.Settings$SecuritySettingsActivity/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”’ Security</span>
          <span class="url">intent://...SecuritySettingsActivity/...</span>
        </a>
        <a class="intent-link" href="intent://com.android.settings/.Settings$AccessibilitySettingsActivity/#Intent;scheme=android-app;end">
          <span class="label">â™¿ Accessibility</span>
          <span class="url">intent://...AccessibilitySettingsActivity/...</span>
        </a>
        <a class="intent-link" href="intent://com.android.settings/.Settings$AccountSettingsActivity/#Intent;scheme=android-app;end">
          <span class="label">ğŸ‘¤ Accounts</span>
          <span class="url">intent://...AccountSettingsActivity/...</span>
        </a>
      </div>
    </div>

    <!-- SAMSUNG TAB -->
    <div id="samsung" class="tab-content">
      <h2>ğŸ“± Samsung Specific</h2>

      <h3>Samsung System Apps</h3>
      <div class="grid">
        <a class="intent-link samsung-link" href="intent://com.sec.android.app.launcher/#Intent;scheme=android-app;end">
          <span class="label">ğŸ  Samsung Launcher</span>
          <span class="url">intent://com.sec.android.app.launcher/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.sec.android.app.myfiles/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“ My Files</span>
          <span class="url">intent://com.sec.android.app.myfiles/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.dialer/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“ Samsung Phone</span>
          <span class="url">intent://com.samsung.android.dialer/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.messaging/#Intent;scheme=android-app;end">
          <span class="label">ğŸ’¬ Messages</span>
          <span class="url">intent://com.samsung.android.messaging/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.contacts/#Intent;scheme=android-app;end">
          <span class="label">ğŸ‘¤ Contacts</span>
          <span class="url">intent://com.samsung.android.contacts/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.sec.android.gallery3d/#Intent;scheme=android-app;end">
          <span class="label">ğŸ–¼ï¸ Gallery</span>
          <span class="url">intent://com.sec.android.gallery3d/...</span>
        </a>
      </div>

      <h3>Samsung Services</h3>
      <div class="grid">
        <a class="intent-link samsung-link" href="intent://com.samsung.android.voc/#Intent;scheme=android-app;end">
          <span class="label">ğŸ‘¥ Samsung Members</span>
          <span class="url">intent://com.samsung.android.voc/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.sec.android.app.samsungapps/#Intent;scheme=android-app;end">
          <span class="label">ğŸª Galaxy Store</span>
          <span class="url">intent://com.sec.android.app.samsungapps/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.oneconnect/#Intent;scheme=android-app;end">
          <span class="label">ğŸ  SmartThings</span>
          <span class="url">intent://com.samsung.android.oneconnect/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.sm/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”§ Device Care</span>
          <span class="url">intent://com.samsung.android.sm/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.themestore/#Intent;scheme=android-app;end">
          <span class="label">ğŸ¨ Theme Store</span>
          <span class="url">intent://com.samsung.android.themestore/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.bixby.agent/#Intent;scheme=android-app;end">
          <span class="label">ğŸ—£ï¸ Bixby</span>
          <span class="url">intent://com.samsung.android.bixby.agent/...</span>
        </a>
      </div>

      <h3>Samsung Apps</h3>
      <div class="grid">
        <a class="intent-link samsung-link" href="intent://com.samsung.android.app.notes/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“ Samsung Notes</span>
          <span class="url">intent://com.samsung.android.app.notes/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.calendar/#Intent;scheme=android-app;end">
          <span class="label">ğŸ“… Calendar</span>
          <span class="url">intent://com.samsung.android.calendar/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.app.routines/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”„ Routines</span>
          <span class="url">intent://com.samsung.android.app.routines/...</span>
        </a>
        <a class="intent-link samsung-link" href="intent://com.samsung.android.samsungpass/#Intent;scheme=android-app;end">
          <span class="label">ğŸ”‘ Samsung Pass</span>
          <span class="url">intent://com.samsung.android.samsungpass/...</span>
        </a>
      </div>
    </div>

    <!-- SECRET CODES TAB -->
    <div id="codes" class="tab-content">
      <h2>ğŸ”¢ Samsung Secret Codes</h2>
      <div class="note info">These require the Phone dialer app. Try launching it first, then dial.</div>

      <h3>â­ ADB/USB Critical</h3>
      <div class="grid">
        <a class="intent-link tel-link priority" href="tel:*#0808#">
          <span class="label">â­ *#0808# - USB Settings</span>
          <span class="url">CRITICAL - Change USB mode to MTP+ADB</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#9900#">
          <span class="label">ğŸ“Š *#9900# - SysDump</span>
          <span class="url">Debug logs, can enable USB debugging</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#7284#">
          <span class="label">ğŸ”Œ *#7284# - USB I2C</span>
          <span class="url">USB path control settings</span>
        </a>
      </div>

      <h3>ğŸ”§ Hardware Diagnostics</h3>
      <div class="grid">
        <a class="intent-link tel-link" href="tel:*#0*#">
          <span class="label">ğŸ”§ *#0*# - Hardware Test</span>
          <span class="url">Full diagnostic menu</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#7353#">
          <span class="label">ğŸ”§ *#7353# - Quick Test</span>
          <span class="url">Quick hardware tests</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#0011#">
          <span class="label">ğŸ“¡ *#0011# - Service Mode</span>
          <span class="url">Network service info</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#0228#">
          <span class="label">ğŸ”‹ *#0228# - Battery</span>
          <span class="url">Detailed battery status</span>
        </a>
      </div>

      <h3>â„¹ï¸ System Info</h3>
      <div class="grid">
        <a class="intent-link tel-link" href="tel:*#06#">
          <span class="label">ğŸ“± *#06# - IMEI</span>
          <span class="url">Shows IMEI number</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#1234#">
          <span class="label">ğŸ“‹ *#1234# - Firmware</span>
          <span class="url">AP/CP/CSC versions</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#12580*369#">
          <span class="label">ğŸ“‹ *#12580*369# - All Info</span>
          <span class="url">Complete SW/HW info</span>
        </a>
      </div>

      <h3>ğŸ“¡ Network</h3>
      <div class="grid">
        <a class="intent-link tel-link" href="tel:*#2263#">
          <span class="label">ğŸ“¡ *#2263# - RF Band</span>
          <span class="url">Network band selection</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#9090#">
          <span class="label">ğŸ”§ *#9090# - Diagnostic</span>
          <span class="url">Debug output config</span>
        </a>
        <a class="intent-link tel-link" href="tel:*#*#4636#*#*">
          <span class="label">ğŸ”§ *#*#4636#*#* - Testing</span>
          <span class="url">Android testing menu</span>
        </a>
      </div>
    </div>

    <!-- QR TAB -->
    <div id="qr" class="tab-content">
      <h2>ğŸ“· QR Code Generator</h2>
      <div class="note info">Generate QR codes to scan with another device's camera/Lens</div>

      <div class="qr-section">
        <input type="text" id="qr-input" placeholder="Tap a link or enter URL here">
        <div class="btn-row">
          <button class="btn" onclick="generateQR()">Generate QR</button>
          <button class="btn btn-secondary" onclick="copyURL()">Copy URL</button>
        </div>
        <div id="qr-code"></div>
        <p id="qr-status" style="color:#888; margin-top:10px; font-size:0.8rem;"></p>
      </div>

      <h3>Quick QR Links</h3>
      <div class="grid">
        <div class="intent-link" onclick="setQR('intent://com.android.settings/#Intent;scheme=android-app;end')">
          <span class="label">âš™ï¸ Settings QR</span>
          <span class="url">Tap to generate QR</span>
        </div>
        <div class="intent-link" onclick="setQR('intent://com.sec.android.app.myfiles/#Intent;scheme=android-app;end')">
          <span class="label">ğŸ“ My Files QR</span>
          <span class="url">Tap to generate QR</span>
        </div>
        <div class="intent-link" onclick="setQR('tel:*#0808#')">
          <span class="label">ğŸ”§ USB Settings Code QR</span>
          <span class="url">Tap to generate QR</span>
        </div>
        <div class="intent-link" onclick="setQR('intent://com.android.settings/.DevelopmentSettings/#Intent;scheme=android-app;end')">
          <span class="label">ğŸ”§ Dev Options QR</span>
          <span class="url">Tap to generate QR</span>
        </div>
      </div>
    </div>

    <!-- DOCS TAB -->
    <div id="docs" class="tab-content">
      <h2>ğŸ“– Documentation</h2>

      <h3>Device Info</h3>
      <table>
        <tr><th>Property</th><th>Value</th></tr>
        <tr><td>Model</td><td>SM-S721B (S24 FE)</td></tr>
        <tr><td>Android</td><td>14</td></tr>
        <tr><td>Firmware</td><td>S721BXXS3AYB3</td></tr>
        <tr><td>FRP Status</td><td>TRIGGERED</td></tr>
        <tr><td>Bootloader</td><td>LOCKED</td></tr>
      </table>

      <h3>âœ… What Works (SM-S721B)</h3>
      <table>
        <tr><th>Method</th><th>Result</th></tr>
        <tr style="color:#4ade80;"><td>ğŸ—£ï¸ Google Assistant</td><td>âœ… Voice commands work!</td></tr>
        <tr style="color:#4ade80;"><td>"Open Display Settings"</td><td>âœ… Works</td></tr>
        <tr style="color:#4ade80;"><td>"Open Accessibility"</td><td>âœ… Works</td></tr>
        <tr style="color:#4ade80;"><td>"Open Sound Settings"</td><td>âœ… Works</td></tr>
        <tr style="color:#4ade80;"><td>"Open Notifications"</td><td>âœ… Works</td></tr>
        <tr style="color:#4ade80;"><td>"Open Device Info"</td><td>âœ… Works (Dev Options won't toggle)</td></tr>
        <tr style="color:#f59e0b;"><td>"Open Play Store"</td><td>âš ï¸ Opens then closes</td></tr>
        <tr style="color:#f59e0b;"><td>"Open YouTube"</td><td>âš ï¸ Opens then closes</td></tr>
      </table>

      <h3>âŒ What Failed (SM-S721B)</h3>
      <table>
        <tr><th>Method</th><th>Result</th></tr>
        <tr style="color:#ef4444;"><td>Chrome intent:// URLs</td><td>âŒ All blocked</td></tr>
        <tr style="color:#ef4444;"><td>Samsung secret codes</td><td>âŒ No trigger</td></tr>
        <tr style="color:#ef4444;"><td>SamFW MTPâ†’ADB</td><td>âŒ Not compatible</td></tr>
        <tr style="color:#ef4444;"><td>USB driver switch</td><td>âŒ No ADB drivers</td></tr>
        <tr style="color:#ef4444;"><td>7x Build Number tap</td><td>âŒ Doesn't enable Dev Options</td></tr>
      </table>

      <h3>ğŸ” Interesting Findings</h3>
      <div class="note info">
        <strong>IntentResolver Crash:</strong> Some share requests cause the IntentResolver app to crash.
        This behavior might be exploitable for navigation bypass.
      </div>

      <h3>Intent URL Format</h3>
      <pre>
intent://[package]/#Intent;scheme=android-app;end

Examples:
intent://com.android.settings/#Intent;scheme=android-app;end
intent://com.sec.android.app.myfiles/#Intent;scheme=android-app;end
      </pre>

      <h3>Attack Chain (Updated)</h3>
      <pre>
FOR SM-S721B (intents blocked):
1. Access Chrome (via keyboard settings)
2. Invoke Google Assistant (hold home or "Hey Google")
3. Use voice commands to open settings
4. Try to find path to Developer Options
5. Or explore IntentResolver crash exploit

FOR OTHER DEVICES (may work):
1. Access Chrome (via keyboard settings)
2. Navigate to this page
3. Tap intent links directly
4. OR scan QR with Lens
5. Target activity opens
6. Enable Developer Options
7. Enable USB Debugging
8. Connect ADB!
      </pre>

      <h3>Researcher</h3>
      <p>Phenix (Alaa Qweider) - <a href="mailto:Alaa@nulled.ai" style="color:#00d4ff;">Alaa@nulled.ai</a></p>
      <p>Test Date: 2026-01-12</p>
    </div>

    <!-- DATABASE TAB - Mobile-First Category View -->
    <div id="database" class="tab-content">
      <!-- Sticky Search & Reset Bar -->
      <div class="db-sticky-bar">
        <input type="text" id="db-search" placeholder="ğŸ” Search..."
          oninput="filterDatabase()">
        <div class="db-bar-info">
          <span id="db-tried-count">Tried: 0</span>
          <button class="btn-reset" onclick="resetIntentView()">ğŸ”„ Reset</button>
        </div>
      </div>

      <!-- Category Sections -->
      <div id="db-categories">
        <!-- Populated by JavaScript with category cards -->
      </div>
    </div>
  </div>

  <!-- Fixed Bottom Quick Actions -->
  <div class="quick-bar">
    <button class="quick-btn highlight" onclick="window.location.href='intent://com.android.settings/#Intent;scheme=android-app;end'">âš™ï¸ Settings</button>
    <button class="quick-btn" onclick="window.location.href='intent://com.sec.android.app.myfiles/#Intent;scheme=android-app;end'">ğŸ“ Files</button>
    <button class="quick-btn" onclick="window.location.href='tel:*#0808#'">ğŸ”§ USB</button>
    <button class="quick-btn" onclick="showTab('qr'); document.querySelector('[onclick*=showTab]').scrollIntoView()">ğŸ“· QR</button>
  </div>

  <script>
    /**
     * DEVICE COMPATIBILITY DATA
     * This structure enables future dynamic device detection and per-device UI customization.
     * When device detection is implemented, this data can show/hide methods based on what works.
     *
     * Research Date: 2026-01-12
     * Researcher: Phenix (Alaa Qweider)
     */
    const deviceData = {
      "SM-S721B": {
        name: "Galaxy S24 FE",
        android: 14,
        firmware: "S721BXXS3AYB3",
        frpStatus: "TRIGGERED",
        bootloader: "LOCKED",
        working: [
          { method: "google_assistant", note: "Voice commands work!" },
          { method: "assistant_display_settings", command: "Open Display Settings" },
          { method: "assistant_accessibility", command: "Open Accessibility" },
          { method: "assistant_sound", command: "Open Sound Settings" },
          { method: "assistant_notifications", command: "Open Notifications" },
          { method: "assistant_device_info", command: "Open Device Info", note: "Dev Options won't toggle" }
        ],
        partial: [
          { method: "assistant_playstore", note: "Opens, asks update, closes. After update: blocked" },
          { method: "assistant_youtube", note: "Opens, asks update, closes. After update: blocked" }
        ],
        notWorking: [
          { method: "chrome_intents", note: "All intent:// URLs blocked" },
          { method: "secret_codes", note: "*#0808#, *#0*#, *#9900# - no trigger" },
          { method: "samfw_mtp_adb", note: "MTPâ†’ADB exploit not compatible" },
          { method: "usb_driver_switch", note: "COM14 - no compatible ADB drivers" },
          { method: "developer_options_toggle", note: "7x build number tap doesn't enable" }
        ],
        interestingBehavior: [
          { finding: "IntentResolver crashes on some share requests" },
          { finding: "Could be exploitable for navigation" }
        ],
        testDate: "2026-01-12"
      }
      // Add more devices as testing continues
    };

    // Current device (for future auto-detection)
    const currentDevice = "SM-S721B";

    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      // Find and activate the matching tab button
      const tabMap = {
        'assistant': 'Assistant',
        'priority': 'Priority',
        'packages': 'Packages',
        'samsung': 'Samsung',
        'codes': 'Codes',
        'qr': 'QR',
        'database': 'Database',
        'docs': 'Docs'
      };
      document.querySelectorAll('.tab').forEach(t => {
        if (t.textContent.includes(tabMap[tabId])) {
          t.classList.add('active');
        }
      });
    }

    let qrCode = null;

    function generateQR() {
      const input = document.getElementById('qr-input').value.trim();
      if (!input) {
        document.getElementById('qr-status').textContent = 'Enter a URL first';
        return;
      }

      const qrDiv = document.getElementById('qr-code');
      qrDiv.innerHTML = '';

      try {
        qrCode = new QRCode(qrDiv, {
          text: input,
          width: 200,
          height: 200,
          colorDark: '#000000',
          colorLight: '#ffffff',
          correctLevel: QRCode.CorrectLevel.L
        });
        document.getElementById('qr-status').textContent = 'âœ… Scan with camera or Lens!';
      } catch(e) {
        document.getElementById('qr-status').textContent = 'Error generating QR';
      }
    }

    function setQR(url) {
      document.getElementById('qr-input').value = url;
      generateQR();
    }

    function copyURL() {
      const input = document.getElementById('qr-input');
      if (!input.value) {
        document.getElementById('qr-status').textContent = 'Nothing to copy';
        return;
      }

      if (navigator.clipboard) {
        navigator.clipboard.writeText(input.value).then(() => {
          document.getElementById('qr-status').textContent = 'ğŸ“‹ Copied!';
        });
      } else {
        input.select();
        document.execCommand('copy');
        document.getElementById('qr-status').textContent = 'ğŸ“‹ Copied!';
      }
    }

    // ============================================
    // INTENT DATABASE - Mobile Category View
    // ============================================

    // Category definitions with icons and priority
    const categories = {
      security: { icon: "ğŸ”’", label: "Lock Screen & Security", priority: "critical" },
      third_party: { icon: "ğŸ“¦", label: "3rd Party FRP Tools", priority: "critical" },
      general: { icon: "âš™ï¸", label: "General Android", priority: "high" },
      settings: { icon: "ğŸ› ï¸", label: "Device Settings", priority: "high" },
      samsung: { icon: "ğŸ“±", label: "Samsung", priority: "high" },
      google: { icon: "ğŸ”µ", label: "Google Apps", priority: "medium" },
      xiaomi: { icon: "ğŸ“±", label: "Xiaomi", priority: "medium" },
      oneplus: { icon: "ğŸ“±", label: "OnePlus", priority: "medium" },
      oppo: { icon: "ğŸ“±", label: "OPPO", priority: "medium" },
      huawei: { icon: "ğŸ“±", label: "Huawei", priority: "medium" },
      realme: { icon: "ğŸ“±", label: "Realme", priority: "medium" },
      pixel: { icon: "ğŸ“±", label: "Google Pixel", priority: "medium" },
      motorola: { icon: "ğŸ“±", label: "Motorola", priority: "low" },
      lg: { icon: "ğŸ“±", label: "LG", priority: "low" },
      sony: { icon: "ğŸ“±", label: "Sony", priority: "low" },
      htc: { icon: "ğŸ“±", label: "HTC", priority: "low" },
      nokia: { icon: "ğŸ“±", label: "Nokia", priority: "low" },
      asus: { icon: "ğŸ“±", label: "Asus", priority: "low" },
      infinix: { icon: "ğŸ“±", label: "Infinix", priority: "low" }
    };

    // Intent database and state
    let intentDatabase = [];
    let triedIntents = [];  // Session-persistent list of tried intent IDs
    let lastTriedId = null;

    // Load database from JSON file
    async function loadDatabase() {
      try {
        const response = await fetch('research/intent-database.json');
        const data = await response.json();
        intentDatabase = data.intents || [];
        renderCategories();
      } catch (err) {
        console.error('Failed to load database:', err);
        document.getElementById('db-categories').innerHTML =
          '<div class="note" style="color:#ef4444;">âŒ Failed to load. ' +
          'Run from local server or check file path.</div>';
      }
    }

    // Render category sections with intent cards
    function renderCategories() {
      const container = document.getElementById('db-categories');
      container.innerHTML = '';

      // Group intents by category
      const grouped = {};
      intentDatabase.forEach(intent => {
        if (!grouped[intent.category]) grouped[intent.category] = [];
        grouped[intent.category].push(intent);
      });

      // Render each category (in priority order from categories object)
      Object.keys(categories).forEach(catKey => {
        const intents = grouped[catKey];
        if (!intents || intents.length === 0) return;

        const cat = categories[catKey];
        const section = document.createElement('div');
        section.className = 'db-category';
        section.id = 'cat-' + catKey;
        section.dataset.priority = cat.priority;
        section.dataset.category = catKey;

        section.innerHTML = `
          <div class="db-cat-header" onclick="toggleCategory('${catKey}')">
            <span class="db-cat-title">
              <span class="icon">${cat.icon}</span>${cat.label}
            </span>
            <span class="db-cat-count">${intents.length}</span>
          </div>
          <div class="db-cat-body" id="cat-body-${catKey}"></div>
        `;
        container.appendChild(section);

        // Render intent cards
        const body = section.querySelector('.db-cat-body');
        renderIntentCards(body, intents, catKey);
      });

      updateTriedCount();
    }

    // Render intent cards within a category
    function renderIntentCards(container, intents, catKey) {
      container.innerHTML = '';

      // Sort: non-tried first, then tried (preserving order within each group)
      const sorted = [...intents].sort((a, b) => {
        const aTried = triedIntents.includes(a.id);
        const bTried = triedIntents.includes(b.id);
        if (aTried && !bTried) return 1;
        if (!aTried && bTried) return -1;
        return 0;
      });

      sorted.forEach(intent => {
        const card = document.createElement('div');
        card.className = 'intent-card';
        card.id = 'intent-' + intent.id;
        card.dataset.intentId = intent.id;
        card.dataset.category = catKey;

        // Apply tried states
        if (intent.id === lastTriedId) {
          card.classList.add('last-tried');
        } else if (triedIntents.includes(intent.id)) {
          card.classList.add('tried');
        }

        card.innerHTML = `
          <div class="ic-label">${intent.label}</div>
          <div class="ic-purpose">${intent.purpose}</div>
        `;
        card.onclick = () => handleIntentClick(intent);
        container.appendChild(card);
      });
    }

    // Handle intent click - grey out, move previous to end, open intent
    function handleIntentClick(intent) {
      // If there was a previously tried intent, mark it as fully tried
      if (lastTriedId && lastTriedId !== intent.id) {
        const prevCard = document.getElementById('intent-' + lastTriedId);
        if (prevCard) {
          prevCard.classList.remove('last-tried');
          prevCard.classList.add('tried');
          // Move to end of its category
          const catBody = prevCard.parentElement;
          catBody.appendChild(prevCard);
        }
      }

      // Mark current as last tried
      if (!triedIntents.includes(intent.id)) {
        triedIntents.push(intent.id);
      }
      lastTriedId = intent.id;

      // Update UI
      const card = document.getElementById('intent-' + intent.id);
      if (card) {
        card.classList.remove('tried');
        card.classList.add('last-tried');
      }
      updateTriedCount();

      // Open the intent URL
      window.location.href = intent.intentUrl;
    }

    // Update tried count display
    function updateTriedCount() {
      const el = document.getElementById('db-tried-count');
      if (el) el.textContent = 'Tried: ' + triedIntents.length;
    }

    // Toggle category open/close
    function toggleCategory(catKey) {
      const section = document.getElementById('cat-' + catKey);
      if (section) section.classList.toggle('open');
    }

    // Filter database by search
    function filterDatabase() {
      const search = document.getElementById('db-search').value.toLowerCase();

      document.querySelectorAll('.db-category').forEach(section => {
        let visibleCount = 0;
        section.querySelectorAll('.intent-card').forEach(card => {
          const label = card.querySelector('.ic-label').textContent.toLowerCase();
          const purpose = card.querySelector('.ic-purpose').textContent.toLowerCase();
          const matches = !search || label.includes(search) || purpose.includes(search);
          card.classList.toggle('hidden', !matches);
          if (matches) visibleCount++;
        });
        // Hide category if no matches
        section.classList.toggle('hidden', visibleCount === 0);
        // Auto-open if searching
        if (search && visibleCount > 0) section.classList.add('open');
      });
    }

    // Reset view - clear tried state and reorder
    function resetIntentView() {
      triedIntents = [];
      lastTriedId = null;
      document.getElementById('db-search').value = '';
      renderCategories();
    }

    // ============================================
    // INITIALIZATION
    // ============================================

    // On load: initialize QR and database
    window.onload = function() {
      // Desktop: pre-generate QR
      if (window.innerWidth >= 600) {
        document.getElementById('qr-input').value =
          'intent://com.android.settings/#Intent;scheme=android-app;end';
        generateQR();
      }
      // Load intent database
      loadDatabase();
    };
  </script>
</body>
</html>
